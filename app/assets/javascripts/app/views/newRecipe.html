<h4 class="text-center">Create a New Recipe </h4>

<form name="newRecipe" ng-submit="newRecipe.$valid && ctrl.submit()"novalidate>

  <h5>Recipe Title: <input name="title" ng-model="ctrl.recipe.title" name="recipeTitle" required></h5>

  <div style="color:red" ng-messages="newRecipe.title.$error" ng-if="newRecipe.title.$touched || newRecipe.$submitted">
    <div ng-message="required">Recipe requires a title</div>
  </div>

  <div ng-repeat="ing in ctrl.recipe.ingredients_attributes">
    <ng-form name="ingredientsForm">

      <select name="selectIngredient"
              ng-model="selectedIngredient"
              ng-options='x.name for x in ctrl.ingredients'
              ng-change="ctrl.setIngredient(selectedIngredient, ing)">
              <option value="">Select</option>
      </select>

      <input  type="text"
              name="ingredientName"
              ng-show="!selectedIngredient"
              ng-model="ing.name"
              placeholder="Enter an ingredient"
              required >

      <input  type="text"
              name="ingredientQuantity"
              ng-model="ing.quantityPrep"
              placeholder="Enter a quantity"
              required >

      <button type="button"
              ng-click="ctrl.addNewField(ing, ctrl.recipe.ingredients_attributes)"
              ng-show="ctrl.showAddField(ing, ctrl.recipe.ingredients_attributes)">
              Add another ingredient
      </button>

      <div style="color:red">

        <div ng-messages="ingredientsForm.ingredientName.$error">
          <div ng-message="required" ng-if="ingredientsForm.ingredientName.$touched" > Not all of your ingredient entries have an ingredient name </div>
        </div>

        <div ng-messages="ingredientsForm.ingredientQuantity.$error">
          <div ng-message="required" ng-if="ingredientsForm.ingredientQuantity.$touched"> Not all of your ingredient entries have an ingredient quantity </div>
        </div>

      </div>

    </ng-form>
  </div>

  <div ng-repeat="step in ctrl.recipe.directions">
    <ng-form name="directionsForm">

      <textarea
              type="text"
              name="direction"
              ng-model="step.content"
              required>
      </textarea>

      <button type="button"
              ng-click="ctrl.removeField(step, ctrl.recipe.directions)"
              ng-show="ctrl.showRemoveField(step, ctrl.recipe.directions)">
              Remove this step
      </button>

      <button type="button"
              ng-click="ctrl.addNewField(step, ctrl.recipe.directions)"
              ng-show="ctrl.showAddField(step, ctrl.recipe.directions)">
              Add another step
      </button>

      <div style="color:red" ng-messages="directionsForm.direction.$error">
        <div ng-message="required" ng-if="directionsForm.direction.$touched"> Not all directions filled out </div>
      </div>

    </ng-form>
  </div>

  <input type="submit" value="submit recipe">


</form>
